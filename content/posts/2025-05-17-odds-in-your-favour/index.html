---
title: May the Odds Be In Your Favour
author: Christopher Nam
date: '2025-05-17'
slug: odds-in-your-favour
categories: [series_19, simulation]
tags: [series_19, simulation]
draft: no
output:
  blogdown::html_page:
    toc: true
    toc_depth: 1
---



<p>Hello</p>
<p>Wow I have forgot how to do this.121</p>
<p>Why aren’t your working</p>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre><code>## ! Using an auto-discovered, cached token.</code></pre>
<pre><code>##   To suppress this message, modify your code or options to clearly consent to
##   the use of a cached token.</code></pre>
<pre><code>##   See gargle&#39;s &quot;Non-interactive auth&quot; vignette for more details:</code></pre>
<pre><code>##   &lt;https://gargle.r-lib.org/articles/non-interactive-auth.html&gt;</code></pre>
<pre><code>## ℹ The googlesheets4 package is using a cached token for
##   &#39;themedianduck@gmail.com&#39;.</code></pre>
<pre><code>## Auto-refreshing stale OAuth token.</code></pre>
<pre><code>## ✔ Reading from &quot;Series 19 Tracker&quot;.</code></pre>
<pre><code>## ✔ Range &#39;&#39;Attempts-Tasks&#39;&#39;.</code></pre>
<pre><code>## ✔ Reading from &quot;Series 19 Tracker&quot;.</code></pre>
<pre><code>## ✔ Range &#39;&#39;Contestants&#39;&#39;.</code></pre>
<pre class="r"><code>head(task_attempt_df)</code></pre>
<pre><code>## # A tibble: 6 × 7
##   `Series ID` `Episode ID` `Task ID` Task          `Task Type` Contestant Points
##         &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
## 1          19            1         1 The object t… Prize       Fatiha El…      1
## 2          19            1         1 The object t… Prize       Jason Man…      5
## 3          19            1         1 The object t… Prize       Mathew Ba…      4
## 4          19            1         1 The object t… Prize       Rosie Ram…      3
## 5          19            1         1 The object t… Prize       Stevie Ma…      2
## 6          19            1         2 Pour all the… Pre-Record  Fatiha El…      4</code></pre>
<pre class="r"><code>num_sim &lt;- 1000 #Number of simulations to perform.

series_length &lt;- 10 #Number of episodes in a series

#Per Episode
num_prize_tasks &lt;- 1 
num_prerecorded_tasks &lt;- 3
num_live_tasks &lt;- 1

num_broadcasted_eps &lt;- length(unique(task_attempt_df$`Episode ID`))
latest_ep_broadcasted &lt;- max(task_attempt_df$`Episode ID`)
contestant_list &lt;- unique(contestants_df$`Contestant Name`)
initials_list &lt;- unique(contestants_df $`Initials`)
task_type_list &lt;- unique(task_attempt_df$`Task Type`)</code></pre>
<pre class="r"><code>initials_list</code></pre>
<pre><code>## [1] &quot;FEG&quot; &quot;JM&quot;  &quot;MB&quot;  &quot;RR&quot;  &quot;SM&quot;</code></pre>
<pre class="r"><code># To simulate one episode</code></pre>
<pre class="r"><code>contestant_iter &lt;- contestant_list[1]
single_sample &lt;- 1 

episode_sample_df &lt;- NULL

for(sample_iter in 1:num_sim){

for(contestant_iter in contestant_list){

    contestant_attempt_df &lt;- task_attempt_df %&gt;% dplyr::filter(Contestant == contestant_iter)
    
    # Prize Task Sampling
    contestant_prize_samples_df &lt;- contestant_attempt_df %&gt;% dplyr::filter(`Task Type` == &quot;Prize&quot; ) %&gt;% slice_sample(n = single_sample * num_prize_tasks, replace = TRUE)
    
    # Live Task Sampling
    contestant_prerecord_samples_df &lt;- contestant_attempt_df %&gt;% dplyr::filter(`Task Type` == &quot;Pre-Record&quot; ) %&gt;% slice_sample(n = single_sample * num_prerecorded_tasks, replace = TRUE)
    contestant_prerecord_samples_df$`Task ID` &lt;- rep(2:4, each = single_sample) 
    
    # Live Task Sampling
    contestant_live_samples_df &lt;- contestant_attempt_df %&gt;% dplyr::filter(`Task Type` == &quot;Live&quot; ) %&gt;% slice_sample(n = single_sample * num_live_tasks, replace = TRUE)
    
    contestant_episode_sample &lt;- rbind(contestant_prize_samples_df, contestant_prerecord_samples_df, contestant_live_samples_df)
    
    contestant_episode_sample$`Episode ID` &lt;- paste0(&quot;Sim &quot;, sample_iter)
    
    episode_sample_df &lt;- rbind(episode_sample_df, contestant_episode_sample)
}
}
episode_sample_df</code></pre>
<pre><code>## # A tibble: 25,000 × 7
##    `Series ID` `Episode ID` `Task ID` Task         `Task Type` Contestant Points
##          &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
##  1          19 Sim 1                1 The snootie… Prize       Fatiha El…      1
##  2          19 Sim 1                2 Answer the … Pre-Record  Fatiha El…      3
##  3          19 Sim 1                3 Win the Pea… Pre-Record  Fatiha El…      3
##  4          19 Sim 1                4 Give Alex e… Pre-Record  Fatiha El…      5
##  5          19 Sim 1                5 Obey Greg’s… Live        Fatiha El…      1
##  6          19 Sim 1                1 The object … Prize       Jason Man…      5
##  7          19 Sim 1                2 Achieve a r… Pre-Record  Jason Man…      1
##  8          19 Sim 1                3 Win the Pea… Pre-Record  Jason Man…      5
##  9          19 Sim 1                4 Do somethin… Pre-Record  Jason Man…      3
## 10          19 Sim 1                5 Put one ite… Live        Jason Man…      3
## # ℹ 24,990 more rows</code></pre>
<pre class="r"><code># Re rank points so that they are from 1-5
episode_sample_df  %&gt;% mutate (`Observed Points Sample` = Points) %&gt;%
    group_by(`Episode ID`, `Task ID`, `Task Type`) %&gt;%
    mutate(Points = rank(`Observed Points Sample`, ties.method = &quot;min&quot;)) %&gt;%
    arrange(`Episode ID`, `Task ID`, `Contestant`)</code></pre>
<pre><code>## # A tibble: 25,000 × 8
## # Groups:   Episode ID, Task ID, Task Type [5,000]
##    `Series ID` `Episode ID` `Task ID` Task         `Task Type` Contestant Points
##          &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt;
##  1          19 Sim 1                1 The snootie… Prize       Fatiha El…      1
##  2          19 Sim 1                1 The object … Prize       Jason Man…      5
##  3          19 Sim 1                1 The best th… Prize       Mathew Ba…      4
##  4          19 Sim 1                1 The snootie… Prize       Rosie Ram…      2
##  5          19 Sim 1                1 The object … Prize       Stevie Ma…      2
##  6          19 Sim 1                2 Answer the … Pre-Record  Fatiha El…      4
##  7          19 Sim 1                2 Achieve a r… Pre-Record  Jason Man…      1
##  8          19 Sim 1                2 Paint a pic… Pre-Record  Mathew Ba…      5
##  9          19 Sim 1                2 Do somethin… Pre-Record  Rosie Ram…      3
## 10          19 Sim 1                2 Give Alex e… Pre-Record  Stevie Ma…      1
## # ℹ 24,990 more rows
## # ℹ 1 more variable: `Observed Points Sample` &lt;dbl&gt;</code></pre>
<pre class="r"><code>#Episode summary for each contestant (summed over tasks), and ranked within that episode. 
episode_summary_df &lt;- episode_sample_df %&gt;% group_by(`Series ID`, `Episode ID`, `Contestant`) %&gt;%
    summarise(`Episode Points` = sum(Points)) %&gt;%
    mutate(`Episode Rank` = rank(-`Episode Points`, ties.method = &quot;min&quot;))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Series ID&#39;, &#39;Episode ID&#39;. You can override
## using the `.groups` argument.</code></pre>
<pre class="r"><code>ggplot(episode_summary_df, aes(x= `Episode Rank`)) +
    geom_bar() + 
    facet_grid(Contestant~.)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>task_attempt_df %&gt;% group_by(&quot;Contestant&quot;, &quot;Task Type&quot;) %&gt;% dplyr::filter(`Task Type` == &quot;Prize&quot; ) %&gt;% slice_sample(n = 50, replace = TRUE)</code></pre>
<pre><code>## # A tibble: 50 × 9
## # Groups:   &quot;Contestant&quot;, &quot;Task Type&quot; [1]
##    `Series ID` `Episode ID` `Task ID` Task         `Task Type` Contestant Points
##          &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;
##  1          19            3         1 The best th… Prize       Mathew Ba…      3
##  2          19            2         1 The snootie… Prize       Fatiha El…      1
##  3          19            1         1 The object … Prize       Fatiha El…      1
##  4          19            2         1 The snootie… Prize       Fatiha El…      1
##  5          19            1         1 The object … Prize       Fatiha El…      1
##  6          19            1         1 The object … Prize       Fatiha El…      1
##  7          19            2         1 The snootie… Prize       Stevie Ma…      4
##  8          19            1         1 The object … Prize       Jason Man…      5
##  9          19            1         1 The object … Prize       Stevie Ma…      2
## 10          19            2         1 The snootie… Prize       Stevie Ma…      4
## # ℹ 40 more rows
## # ℹ 2 more variables: `&quot;Contestant&quot;` &lt;chr&gt;, `&quot;Task Type&quot;` &lt;chr&gt;</code></pre>
